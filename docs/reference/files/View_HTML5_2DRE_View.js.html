<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>View&#x2F;HTML5_2DRE_View.js - Eracle HTML5_2DRE</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets&#x2F;css&#x2F;logo.jpg" title="Eracle HTML5_2DRE"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: Eracle HTML5_2DRE<br />
             version: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Array.html">Array</a></li>
            
                <li><a href="..&#x2F;classes/BaseDrawable.html">BaseDrawable</a></li>
            
                <li><a href="..&#x2F;classes/Boolean.html">Boolean</a></li>
            
                <li><a href="..&#x2F;classes/ButtonDrawable.html">ButtonDrawable</a></li>
            
                <li><a href="..&#x2F;classes/Controller.html">Controller</a></li>
            
                <li><a href="..&#x2F;classes/Date.html">Date</a></li>
            
                <li><a href="..&#x2F;classes/HTML5_2DRE.html">HTML5_2DRE</a></li>
            
                <li><a href="..&#x2F;classes/Model.html">Model</a></li>
            
                <li><a href="..&#x2F;classes/Number.html">Number</a></li>
            
                <li><a href="..&#x2F;classes/Object.html">Object</a></li>
            
                <li><a href="..&#x2F;classes/RectangleDrawable.html">RectangleDrawable</a></li>
            
                <li><a href="..&#x2F;classes/SpriteDrawable.html">SpriteDrawable</a></li>
            
                <li><a href="..&#x2F;classes/String.html">String</a></li>
            
                <li><a href="..&#x2F;classes/TextDrawable.html">TextDrawable</a></li>
            
                <li><a href="..&#x2F;classes/View.html">View</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/Controller.html">Controller</a></li>
            
                <li><a href="..&#x2F;modules/Drawables.html">Drawables</a></li>
            
                <li><a href="..&#x2F;modules/Model.html">Model</a></li>
            
                <li><a href="..&#x2F;modules/root.html">root</a></li>
            
                <li><a href="..&#x2F;modules/View.html">View</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: View&#x2F;HTML5_2DRE_View.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;&#x2F; Copyright (c) 2012 All Right Reserved, Eracle Software and Thomas van der Berg
&#x2F;&#x2F;
&#x2F;&#x2F; This source is subject to the Eracle License.
&#x2F;&#x2F; Please see the license page on http:&#x2F;&#x2F;eraclesoftware.com&#x2F;legal&#x2F; file for more information.
&#x2F;&#x2F; All other rights reserved.
&#x2F;&#x2F;
&#x2F;&#x2F; THIS CODE AND INFORMATION ARE PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY 
&#x2F;&#x2F; KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
&#x2F;&#x2F; IMPLIED WARRANTIES OF MERCHANTABILITY AND&#x2F;OR FITNESS FOR A
&#x2F;&#x2F; PARTICULAR PURPOSE.
&#x2F;&#x2F;
&#x2F;&#x2F; authors:	Ylon Schaeffer, Thomas van der Berg
&#x2F;&#x2F; email:	yschaeffer@eraclesoftware.com, thomas.van.der.berg@hotmail.com
&#x2F;&#x2F; date:	14-11-2012
&#x2F;&#x2F; summary:	View element of the HTML5_2DREngine.

&#x2F;**
View element
@module View
*&#x2F;
&#x2F;**
View element of the HTML5_2DREngine.
@class View
*&#x2F;

View = {
	&#x2F;**
	HTML ID for the Canvas element to use.
	@property canvasID
	@type String
	@default &quot;HTML5_2DRE&quot;
	*&#x2F;
	canvasID		:	&quot;HTML5_2DRE&quot;,
	&#x2F;**
	Contains the canvas element.
	@property canvas
	@type HTMLDomObject
	@default null
	*&#x2F;
	canvas			:	null,
	&#x2F;**
	Contains the Canvas&#x27; 2D renderer.
	@property ctx
	@type Object
	@default null
	*&#x2F;
	ctx 			: 	null,
	&#x2F;**
	targeted fps which you like to run this game at (default 50).
	@property fps
	@type Number
	@default 50
	*&#x2F;
	fps 			:	50,
	&#x2F;**
	(do not set) time to start the next update&#x2F;draw., will be set by start function
	@property fpsinterval
	@type Number
	@default 0
	*&#x2F;
	fpsinterval		:	0,
	&#x2F;**
	Last FPS.
	@property lastfps
	@type Number
	@default 0
	*&#x2F;
	lastfps 		:	0,
	&#x2F;**
	will count up every frame it renders.
	@property fpscounter
	@type Number
	@default 0
	*&#x2F;
	fpscounter		:	0,
	&#x2F;**
	(do not set) will count to 1 with deltatime and when hit will grab &lt;fpscounter&gt; count and set it into &lt;lastfps&gt;.
	@property fpstimer
	@type Number
	@default 0
	*&#x2F;
	fpstimer		:	0,
	&#x2F;**
	The width of the game in pixels.
	@property canvasWidth
	@type Number
	@default 0
	*&#x2F;	
	canvasWidth 	:	0,
	&#x2F;**
	The height of the game in pixels.
	@property canvasHeight
	@type Number
	@default 0
	*&#x2F;
	canvasHeight	:	0,
	&#x2F;**
	Object currently being clicked on by the mouse.
	@property mhoverObject
	@type BaseDrawable
	@default null
	*&#x2F;
	mhoverObject	:	null,
	&#x2F;**
	Object which the mouse is hovering over.
	@property mdownObject
	@type BaseDrawable
	@default null
	*&#x2F;
	mdownObject		:	null,
	
	&#x2F;**
	Initializes the View, Connects to the canvas and gets its variables. Sets desired FPS.
	@method init
	@returns {Boolean} True if it could connect to the HTML canvas with the canvas ID. Otherwise false.
	*&#x2F;
	init :	function()
	{
		this.canvas = document.getElementById(this.canvasID);
		if (this.canvas.getContext)
		{
			this.ctx = this.canvas.getContext(&#x27;2d&#x27;);
			this.canvas.onselectstart = function () { return false; }
			this.canvas.oncontextmenu = function () { return false; }
			this.canvasWidth = this.canvas.width;
			this.canvasHeight = this.canvas.height;
			this.fpsinterval = 1000 &#x2F; this.fps;
			
			this.canvas.onmousedown = 	function(e) { View.mousedown(e); }
			this.canvas.onmouseup 	= 	function(e) { View.mouseup(e); }
			this.canvas.onmousemove = 	function(e) { View.mousemove(e); }
			this.canvas.ondblclick 	= 	function(e) { View.mousedblclick(e); }
			
			return true;
		}
		return false;
	},
	
	&#x2F;**
	Draws every object on the canvas every frame.
	@method base_draw
	*&#x2F;
	base_draw	:	function()
	{
		this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
		
		for(var i = 0; i &lt; Model.drawableObjects.length; i++)
			if(Model.drawableObjects[i])
			{
				this.ctx.save();
				this.ctx.translate(Model.drawableObjects[i].position.x + (Model.drawableObjects[i].size.x &#x2F; 2), Model.drawableObjects[i].position.y + (Model.drawableObjects[i].size.y &#x2F; 2));
				this.ctx.rotate(Model.drawableObjects[i].rotation);
				this.ctx.globalAlpha = Model.drawableObjects[i].alpha;
				Model.drawableObjects[i].base_draw(this.ctx);
				this.ctx.restore();
			}
		
		if(this.fpstimer &gt;= 1)
		{
			this.lastfps = this.fpscounter;
			this.fpscounter = 0;
			this.fpstimer = 0;
		}
		
		this.fpstimer += deltaTime;
		this.fpscounter++;
		
		if(this.draw)
			this.draw();
	},

	&#x2F;**
	Will return the position of the mouse on the canvas.
	@method mouseposition
	@param e {event} event object
	@returns [x, y] JSON positions
	*&#x2F;
	mouseposition			:	function(e)
	{
		var rect = this.canvas.getBoundingClientRect(), root = document.documentElement;
	
		&#x2F;&#x2F; return relative mouse position
		var mouseX = e.clientX - rect.left;
		var mouseY = e.clientY - rect.top;
			
		return { x: mouseX, y: mouseY };
	},

	&#x2F;**
	Called when the mouse is clicked. Will set &lt;mdownObject&gt; to the currently clicked object.
	@method mousedown
	@param e {event} event object
	*&#x2F;
	mousedown		:	function(e)
	{
		var mposition = this.mouseposition(e);
		this.mdownObject = this.getobjectatpos(mposition.x, mposition.y);
	},
	
	&#x2F;*
	Called when the mouse button is released. Will call &lt;Controller.mouse_objectClick&gt; with the object the mouse is hovering over as parameter if it is the same object it was pressed down on.
	@method mouseup
	@param e {event} event object
	*&#x2F;
	mouseup			:	function(e)
	{
		var mposition = this.mouseposition(e);
		var object = this.getobjectatpos(mposition.x, mposition.y);
		if(object !== null &amp;&amp; this.mdownObject === object)
			Controller.mouse_objectClick(object);
		
		object = null;
	},
	
	&#x2F;**
	Called when the mouse moves.

	Will call the &lt;Controller.mouse_objectHover&gt; when &lt;mhoverObject&gt; is hovered by the mouse.
	Will call the &lt;Controller.mouse_objectHoverOut&gt; when &lt;mhoverObject&gt; is no longer being hovered.
	@method mousemove
	@param e {event} event object
	*&#x2F;
	mousemove			:	function(e)
	{		
		var mposition = this.mouseposition(e);
		var object = this.getobjectatpos(mposition.x, mposition.y);
		if(this.mhoverObject !== null &amp;&amp; object != this.mhoverObject)
			Controller.mouse_objectHoverOut(object);
		
		if(object)
		{
			this.canvas.style.cursor = object.cursor;
			Controller.mouse_objectHover(object);
			this.mhoverObject = object;
		}
		else
		{
			&#x2F;&#x2F;reset to default settings
			this.setstyledefaults();
			this.mhoverObject = null;
		}
	},
	
	&#x2F;**
	When the mouse hovers out of an object this function will be called to return settings to their defaults.
	@method setstyledefaults
	*&#x2F;
	
	setstyledefaults			:	function()
	{
		this.canvas.style.cursor = &quot;default&quot;;
	},
	
	&#x2F;**
	Called when the mouse is clicked twice in short succession.
	Will call &lt;Controller.mouse_objectDoubleClick&gt; 
	@method mousedblclick
	@param e {event} event object
	*&#x2F;
	mousedblclick			:	function(e)
	{
		var mposition = this.mouseposition(e);
		var object = this.getobjectatpos(mposition.x, mposition.y);
		if(object !== null &amp;&amp; this.mdownObject === object)
			Controller.mouse_objectDoubleClick(object);
		
		object = null;
	},
	
	&#x2F;**
	Will get the object at the given position.
	@method getobjectatpos
	@param x {Number} x position to check.
	@param y {Number} y position to check.
	*&#x2F;
	getobjectatpos				:	function(x, y)
	{
		if(!x || !y)
			return false;
		
		if(Model.drawableObjects &amp;&amp; Model.drawableObjects.length &gt; 0)
			for(var i = Model.drawableObjects.length - 1; i &gt;= 0; i--)
				if(	x &gt;= Model.drawableObjects[i].position.x &amp;&amp; x &lt;= Model.drawableObjects[i].position.x + Model.drawableObjects[i].size.x &amp;&amp;
					y &gt;= Model.drawableObjects[i].position.y &amp;&amp; y &lt;= Model.drawableObjects[i].position.y + Model.drawableObjects[i].size.y &amp;&amp;
					Model.drawableObjects[i].visible)
					return Model.drawableObjects[i].getobjectatpos(x, y);
		
		return null;
	}
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
